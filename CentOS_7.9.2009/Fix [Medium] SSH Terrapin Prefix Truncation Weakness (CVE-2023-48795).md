# How to fix `SSH Terrapin Prefix Truncation Weakness (CVE-2023-48795)`

#### backup sshd_config 
```bash
cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
```
#### Edit `/etc/ssh/sshd_config`
```bash
vi /etc/ssh/sshd_config
```
#### OLD config
```bash
# insert chiper
# Ciphers and keying
#RekeyLimit default none
```
To

### Disable risky algorithms and enable secure algorithms in /etc/ssh/sshd_config:
#### Disable risky algorithms:
```
• # KexAlgorithms ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521
• # Ciphers chacha20-poly1305@openssh.com
• # MACs hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-
256-etm@openssh.com
```
#### Enable secure algorithms:
```
• KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org
• Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com
• MACs hmac-sha2-512,hmac-sha2-256
```
#### Restart the SSH server.
```
• sudo systemctl restart sshd
```
